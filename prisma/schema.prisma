generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(cuid())
  name      String?
  email     String  @unique
  password  String
  createdAt DateTime @default(now())
  updatedAt DateTime @default(now())

  deals Deal[]
}

enum DealStage {
  New
  Qualified
  Proposal
  Won
  Lost
}

enum Currency {
  USD
  EUR
  GBP
}

model Deal {
  id        String    @id @default(uuid())
  dealName  String
  company   String
  contact   String?
  stage     DealStage
  amount    Float
  currency  Currency
  ownerId   String
  owner     User      @relation(fields: [ownerId], references: [id], onDelete: Cascade)
  closeDate DateTime?
  tags      String[]  @default([])
  notes     String?
  files     Json?     // array of file metadata objects (name, url, size, etc.)
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt

  @@index([ownerId])
}
